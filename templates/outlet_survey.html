<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Assigned Outlets</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='survey_style.css') }}">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='style2.css') }}">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
		integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw=="
		crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- <small><a href="{{ url_for('user_dashboard') }}" class="btn-dashboard">Dashboard</a></small> -->
</head>
<body>

<div class="dashboard">
		<!-- Sidebar -->
		<aside class="sidebar" id="sidebar">
			<button id="closeBtn" aria-label="Close Menu">&times;</button>
			<img src="{{ url_for('static', filename='slmg-logo-white.png') }}" alt="SLMG Logo" title="SLMG"
				style="width:100%;" />
			<a href="{{ url_for('user_dashboard') }}">Dashboard</a>
			<a class="active" href="{{ url_for('outlet_survey') }}">Outlet Survey</a>
			<a href="{{ url_for('complete_survey') }}">All Completed</a>
			<a href="{{ url_for('new_complete_outlet') }}">New Complete Outlet List</a>
			<a href="{{ url_for('logout') }}">Logout</a>
			<div class="side-footer-img">
				<img src="{{ url_for('static', filename='bottle-logo.webp') }}" alt="SLMG Logo" title="SLMG" />
			</div>
		</aside>


		<!-- Overlay -->
		<div class="overlay" id="overlay"></div>
		<section class="outer-container">
			<!-- Main Content -->
			<main class="main-content">
				<!-- Topbar -->
				<header class="topbar">
					<!-- Welcome Banner -->
					<div class="content">
						<h1>Assigned Outlets - {{ user.EMP_NAME }}</h1>
						<p>Glad to see you again!</p>
					</div>
					<!-- Hamburger Icon -->
					<div class="hamburger" id="hamburger" aria-label="Open Menu" role="button" tabindex="0">
						<div></div>
						<div></div>
						<div></div>
					</div>

					<div class="user-info">
						<!-- <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" alt="user-icon" /> -->
						<span class="user-icon"><i class="fa fa-user" aria-hidden="true"></i></span>
						<div class="user-content">
							<strong>{{ user.EMP_NAME }}</strong><br />
							<small>{{ user.EMAIL_ID }}</small>
						</div>
					</div>
				</header>

				
<div class="table-section">
    <a href="{{ url_for('new_outlet_survey') }}" class="btn-new">âž• New</a>
    <a href="{{ url_for('change_distributor') }}" class="btn-new">Change Distributor</a>
    <table id="outletTable" class="display">
    <thead>
        <tr>
            <th>TRANSACTIONS ID</th>    
            <th>Outlet Code</th>
            <th>Outlet Name</th>
            <th>Address</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for row in data %}
        <tr>
            <td>{{ row[0] }}</td>  <!-- TRANSACTIONS_ID -->
            <td>{{ row[1] }}</td>  <!-- OUTLET_CODE -->
            <td>{{ row[2] }}</td>  <!-- OUTLET_NAME -->
            <td>{{ row[3] }}</td>  <!-- OUTLET_ADDRESS -->
            <td>
                <a href="{{ url_for('edit_survey', transaction_id=row[0]) }}" class="edit-btn">Edit</a>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
</div>

                
			</main>
		</section>
	</div>

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
<script>
    $(document).ready(function () {
    var table = $('#outletTable').DataTable();

    // Live search as user types
    $('#outletSearch').on('keyup', function () {
        table.search(this.value).draw();
    });

    // Trigger search when the Search button is clicked
    $('.btn-search').on('click', function () {
        var query = $('#outletSearch').val();
        table.search(query).draw();
    });
});    
</script>
{% with messages = get_flashed_messages() %}
  {% if messages %}
    <div class="alert alert-info" role="alert">
      {% for message in messages %}
        {{ message }}
      {% endfor %}
    </div>
  {% endif %}
{% endwith %}

<script>
		const hamburger = document.getElementById('hamburger');
		const sidebar = document.getElementById('sidebar');
		const overlay = document.getElementById('overlay');
		const closeBtn = document.getElementById('closeBtn');

		function openSidebar() {
			sidebar.classList.add('show');
			overlay.classList.add('show');
		}

		function closeSidebar() {
			sidebar.classList.remove('show');
			overlay.classList.remove('show');
		}

		hamburger.addEventListener('click', openSidebar);
		closeBtn.addEventListener('click', closeSidebar);
		overlay.addEventListener('click', closeSidebar);

		// Keyboard accessibility for hamburger
		hamburger.addEventListener('keydown', function (e) {
			if (e.key === 'Enter' || e.key === ' ') {
				e.preventDefault();
				openSidebar();
			}
		});

		// Keyboard accessibility for close button
		closeBtn.addEventListener('keydown', function (e) {
			if (e.key === 'Enter' || e.key === ' ') {
				e.preventDefault();
				closeSidebar();
			}
		});
	</script>
    
</body>
</html>
